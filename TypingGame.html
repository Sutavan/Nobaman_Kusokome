
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>のばまんにクソコメを送るゲーム</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: black;
      color: white;
      overflow: hidden;
    }
    #background {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 60vw;
      z-index: -1;
    }
    video {
      width: 100%;
      height: auto;
    }
    #logo {
      position: absolute;
      bottom: 40px;
      right: 20px;
      width: 240px;
      z-index: 1;
    }
    #start-button, #audio-button {
      position: absolute;
      padding: 12px 24px;
      font-size: 18px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      z-index: 2;
    }
    #start-button {
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #FF0000;
      color: white;
    }
    #start-button:hover {
      background-color: #cc0000;
    }
    #audio-button {
      top: 20px;
      left: 20px;
      background: white;
      color: black;
    }
    #game-screen {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 10;
      text-align: center;
      padding-top: 120px;
      font-size: 24px;
    }
    #typing-text {
      margin-top: 40px;
      font-size: 24px;
    }
    #input-area {
      margin-top: 20px;
    }
    #input-box {
      padding: 10px;
      font-size: 20px;
      width: 60%;
      border: 3px solid white;
      outline: none;
    }
    #subscriber-box {
      position: absolute;
      top: 20px;
      right: 20px;
      text-align: right;
      font-size: 16px;
    }
    #unsubscribe-button {
      margin-top: 10px;
      padding: 5px 10px;
      font-size: 14px;
      background: red;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #result-screen {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: black;
      color: white;
      z-index: 20;
      text-align: center;
      padding-top: 160px;
      font-size: 28px;
    }
  </style>
</head>
<body>
  <div id="background">
    <video id="bg-video" autoplay loop muted>
      <source src="./トプ画絵_音声付き軽量版.mp4" type="video/mp4">
    </video>
  </div>
  <img id="logo" src="./のばまんロゴ.jpg" alt="のばまんロゴ">
  <button id="start-button">視聴開始</button>
  <button id="audio-button">音声ON</button>
  <div id="game-screen">
    <div id="subscriber-box">
      <div id="subscriber-count">登録者数: 49900</div>
      <div id="alert" style="color: red; font-weight: bold;"></div>
      <button id="unsubscribe-button" onclick="unsubscribe()">登録解除</button>
    </div>
    <div id="timer">残り: 60秒</div>
    <div id="typing-text"></div>
    <div id="input-area">
      <input type="text" id="input-box" placeholder="ここに入力" autocomplete="off" />
    </div>
  </div>
  <div id="result-screen"></div>
  <script>
    const bgVideo = document.getElementById('bg-video');
    const startButton = document.getElementById('start-button');
    const audioButton = document.getElementById('audio-button');
    const gameScreen = document.getElementById('game-screen');
    const logo = document.getElementById('logo');
    const inputBox = document.getElementById('input-box');
    const typingText = document.getElementById('typing-text');
    const timerDisplay = document.getElementById('timer');
    const subscriberCountDisplay = document.getElementById('subscriber-count');
    const alertBox = document.getElementById('alert');
    const resultScreen = document.getElementById('result-screen');

    let audioOn = false;
    let timeLeft = 60;
    let timerInterval;
    let subscriberCount = 49900;
    let subscriberInterval;
    let correctCount = 0;
    let totalCount = 0;

    const unsubscribe = () => {
      const delta = Math.floor(Math.random() * 91) + 10;
      subscriberCount -= delta;
      updateSubscriberDisplay();
    };

    const texts = [
      'もう飽きてたわ', '同じようなネタばっか', '飽きた',
      '倫理的にアウトオブ眼中やな', 'これもうホラーゲームだろ',
      '繰り返しの多いコンテンツ', '引退マジかよ', 'まさか炎上か？',
      '大量生産コンテンツ'
    ];
    let currentIndex = 0;

    const updateSubscriberDisplay = () => {
      subscriberCountDisplay.innerText = `登録者数: ${subscriberCount}`;
      alertBox.innerText = subscriberCount > 500000 ? '下げろ！' : '';
    };

    const updateTimer = () => {
      timerDisplay.innerText = `残り: ${timeLeft}秒`;
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        clearInterval(subscriberInterval);
        showResult();
      }
      timeLeft--;
    };

    const nextText = () => {
      typingText.innerText = texts[currentIndex];
      inputBox.value = '';
      inputBox.style.borderColor = 'white';
      currentIndex = (currentIndex + 1) % texts.length;
    };

    const showResult = () => {
      gameScreen.style.display = 'none';
      resultScreen.style.display = 'block';
      const rate = correctCount / totalCount;
      let rank = 'D';
      if (rate >= 0.9) rank = 'S';
      else if (rate >= 0.75) rank = 'A';
      else if (rate >= 0.6) rank = 'B';
      else if (rate >= 0.4) rank = 'C';
      resultScreen.innerHTML = `ゲーム終了！<br>正答率: ${(rate * 100).toFixed(1)}%<br>ランク: ${rank}`;
    };

    audioButton.onclick = () => {
      audioOn = !audioOn;
      bgVideo.muted = !audioOn;
      audioButton.textContent = audioOn ? '音声OFF' : '音声ON';
    };

    startButton.onclick = () => {
      startButton.style.display = 'none';
      audioButton.style.display = 'none';
      logo.style.display = 'none';
      gameScreen.style.display = 'block';
      updateSubscriberDisplay();
      timerInterval = setInterval(updateTimer, 1000);
      subscriberInterval = setInterval(() => {
        const delta = Math.floor(Math.random() * 91) + 10;
        subscriberCount += delta;
        if (subscriberCount >= 501000) {
          clearInterval(timerInterval);
          clearInterval(subscriberInterval);
          alert('50万人到達してしまった！ゲームオーバー！');
          location.reload();
        }
        updateSubscriberDisplay();
      }, 1000);
      nextText();
    };

    inputBox.addEventListener('input', () => {
      const target = typingText.innerText;
      const current = inputBox.value;
      inputBox.style.borderColor = target.startsWith(current) ? 'lime' : 'red';
    });

    inputBox.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        totalCount++;
        const input = inputBox.value.trim();
        if (input === typingText.innerText) {
          correctCount++;
          nextText();
        } else {
          inputBox.style.borderColor = 'red';
        }
      }
    });
  </script>
</body>
</html>
